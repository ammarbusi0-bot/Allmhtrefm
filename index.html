<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ğŸ’¡ ØªØ­Ø¯ÙŠ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© - ÙÙ‚Ù‡ ÙˆØ£Ø³Ø¦Ù„Ø© Ù…ØªÙ†ÙˆØ¹Ø©</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
<style>
/* ÙƒÙˆØ¯ Ø§Ù„ØªØµÙ…ÙŠÙ… CSS */
body {font-family:'Amiri',serif;background:linear-gradient(to bottom,#0d1b1e,#0c2c24);color:#f8f9fa;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:1.5rem;}
.container {max-width:48rem;width:100%;margin-top:1rem;}
.question-card {background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.1);border-radius:1.5rem;box-shadow:0 4px 20px rgba(255,215,0,0.2);transition:transform 0.3s ease, box-shadow 0.3s ease,opacity 0.4s ease;opacity:0;animation:fadeIn 0.5s forwards;padding:1.5rem;}
@keyframes fadeIn {from {opacity:0; transform:translateY(20px);} to {opacity:1; transform:translateY(0);}}
.answer-btn {transition:all 0.3s ease;text-align:center;border:2px solid transparent;white-space:normal;line-height:1.3;min-height:50px;display:flex;align-items:center;justify-content:center;background-color:#059669;}
.answer-btn:not(.correct):not(.wrong):hover {background-color:#047857;transform:scale(1.02);}
.correct {background-color:#10B981!important;border-color:#059669!important;pointer-events:none;}
.wrong {background-color:#EF4444!important;border-color:#DC2626!important;pointer-events:none;}
.answered {pointer-events:none;}
.progress-bar {height:8px;background:rgba(255,255,255,0.2);border-radius:4px;overflow:hidden;margin:1rem 0;}
.progress-fill {height:100%;background:linear-gradient(to right,#f59e0b,#eab308);transition:width 0.5s ease;}
.timer-bar {height:8px;background:#FEE715;border-radius:4px;overflow:hidden;margin-bottom:0.5rem;box-shadow:0 0 10px rgba(255,255,255,0.3);}
.timer-fill {height:100%;background:#F97316;width:100%;transition:width 15s linear;}
#timer {margin-top:0.5rem;}
#timer-number {font-weight:bold;}
#info-box {background:rgba(255, 255, 255, 0.1); padding:1rem; border-radius:1rem; margin-top:1rem; text-align:right;}

/* ************************************ */
/* ** ÙƒÙˆØ¯ CSS Ù…Ø¶Ø§Ù Ù„Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (ÙˆØ³Ù… <video>) ** */
/* ************************************ */
.video-container {
    display: flex;
    justify-content: center;
    margin-bottom: 2rem;
    padding: 0 1rem;
    max-width: 100%;
}
.video-container video {
    max-width: 100%;
    height: auto;
    border-radius: 1rem;
    box-shadow: 0 4px 20px rgba(255,215,0,0.3);
}

/* ************************************ */
/* ** ÙƒÙˆØ¯ CSS Ù…Ø¶Ø§Ù Ù„Ù‚Ø³Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„ÙØ§Ø®Ø± ** */
/* ************************************ */
.contact-section {
    background: linear-gradient(135deg, #1f4037, #0c2c24); 
    padding: 2.5rem 1.5rem;
    margin-top: 3rem;
    border-radius: 1.5rem;
    border: 1px solid #eab308;
    box-shadow: 0 10px 30px rgba(234, 179, 8, 0.3);
    max-width: 48rem;
    width: 100%;
    text-align: center;
}
.contact-link {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-weight: bold;
    margin: 0.5rem 0;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    text-decoration: none;
    color: #f8f9fa;
    white-space: nowrap;
}
.contact-link:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
}
.whatsapp-btn { background-color: #25D366; }
.telegram-btn { background-color: #0088CC; }
.tiktok-btn { background-color: #000000; border: 1px solid #f8f9fa; }
.email-btn { background-color: #ea4335; }
.icon {
    font-size: 1.5rem;
    margin-left: 0.75rem;
    line-height: 1;
}
/* ************************************ */
/* ** ÙƒÙˆØ¯ CSS Ù…Ø¶Ø§Ù Ù„Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ** */
/* ************************************ */
#login-screen {
    background: linear-gradient(160deg, #1c3d3a, #0d1b1e);
    border: 2px solid #f59e0b;
    padding: 2.5rem;
    max-width: 28rem;
    margin: 2rem auto;
}
.input-group label {
    display: block;
    text-align: right;
    margin-bottom: 0.5rem;
    color: #eab308;
    font-weight: bold;
}
.input-group input {
    width: 100%;
    padding: 0.75rem;
    margin-bottom: 1.5rem;
    border-radius: 0.5rem;
    border: 1px solid #059669;
    background-color: rgba(255, 255, 255, 0.1);
    color: white;
}
.action-buttons button {
    width: 48%;
    padding: 0.75rem;
    font-size: 1.1rem;
}
</style>
</head>
<body class="text-center">

<header class="mb-8 w-full max-w-4xl">
<h1 class="text-4xl md:text-5xl font-extrabold text-yellow-300 mb-2">ğŸ’¡ ØªØ­Ø¯ÙŠ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</h1>
<p class="text-gray-300 text-lg">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø§Ù„Ø¯ÙŠÙ†ÙŠØ© ÙˆØ§Ù„ÙÙ‚Ù‡ÙŠØ© â€” 10 Ø£Ø³Ø¦Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙƒÙ„ Ø¬ÙˆÙ„Ø©</p>

<div class="video-container mx-auto mt-6 w-full max-w-xl">
    <video 
        class="rounded-xl shadow-2xl w-full"
        controls 
        preload="metadata"> 
        
        <source src="VID_20251027_220735_527.mp4" type="video/mp4">
        
        <p>Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.</p>
    </video>
</div>
<audio id="background-music" src="https://assets.mixkit.co/sfx/preview/mixkit-lo-fi-hip-hop-loop-803.mp3" loop autoplay></audio> 
<button id="music-toggle-btn" class="mt-3 text-sm font-semibold text-gray-300 hover:text-yellow-400 transition flex items-center justify-center mx-auto">
    <span id="music-icon">ğŸµ</span>
    <span id="music-status" class="mr-2">Ø¥ÙŠÙ‚Ø§Ù</span>
</button>
</header>

<div class="progress-bar w-full max-w-4xl">
<div id="progress-fill" class="progress-fill" style="width: 0%"></div>
</div>

<main id="quiz" class="container">
    <div id="login-screen" class="question-card mt-6 p-8 hidden" style="opacity:1; transform:translateY(0);">
        <p class="text-3xl font-extrabold text-yellow-300 mb-4">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠ!</p>
        <p class="text-lg text-gray-300 mb-6">Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯.</p>
        
        <div class="input-group text-right">
            <label for="username">Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨:</label>
            <input type="text" id="username" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ù…ÙŠØ²" required />
        </div>
        
        <div class="input-group text-right">
            <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
            <input type="password" id="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />
        </div>
        
        <div class="action-buttons flex justify-between">
            <button id="login-btn" class="bg-green-600 hover:bg-green-500 text-white font-bold rounded-xl transition shadow-lg">
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ğŸ”‘
            </button>
            <button id="register-btn" class="bg-yellow-600 hover:bg-yellow-500 text-gray-900 font-bold rounded-xl transition shadow-lg">
                Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ âœ¨
            </button>
        </div>
        <p id="auth-message" class="mt-4 text-sm font-semibold text-red-400 hidden"></p>
    </div>

    <div id="welcome-screen" class="question-card mt-6 p-8" style="opacity:1; transform:translateY(0);">
        <p class="text-3xl font-extrabold text-yellow-300 mb-4">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØªØ­Ø¯ÙŠ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©!</p>
        <p class="text-xl text-gray-200 mb-8">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙÙŠ Ø§Ù„ÙÙ‚Ù‡ ÙˆØ§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ Ø¨Ù€ 10 Ø£Ø³Ø¦Ù„Ø© Ø³Ø±ÙŠØ¹Ø©.</p>
        <p class="text-lg text-red-300 mb-8">Ù„Ø¯ÙŠÙƒ 15 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ø³Ø¤Ø§Ù„. Ø§Ø³ØªØ¹Ø¯ Ø¬ÙŠØ¯Ø§Ù‹!</p>
        <button id="start-quiz-btn" class="bg-yellow-500 hover:bg-yellow-400 text-gray-900 font-bold py-3 px-8 rounded-full text-xl transition shadow-lg">
            Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ Ø§Ù„Ø¢Ù† âœ¨
        </button>
    </div>
    <div id="loading-message" class="text-xl mt-12 text-yellow-300 hidden">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©... â³</div>
</main>
<div id="result" class="mt-6 text-2xl md:text-3xl font-bold hidden p-4 rounded-xl shadow-2xl"></div>
<button id="next-btn" class="mt-6 hidden bg-yellow-500 hover:bg-yellow-400 text-gray-900 font-bold py-3 px-6 rounded-full text-xl transition shadow-lg">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
<div id="timer" class="text-gray-300 text-sm hidden">
  <p>Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø³ØªØªØ¬Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
  <p>ÙˆÙ‚Øª Ø§Ù„Ø³Ø¤Ø§Ù„: <span id="timer-number">15</span> Ø«Ø§Ù†ÙŠØ©</p>
</div>
<audio id="sound-correct" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="sound-wrong" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="sound-timeup" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>

<footer class="contact-section mx-auto">
    <h3 class="text-3xl font-extrabold text-yellow-300 mb-6">ğŸ”‘ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠ</h3>
    <p class="text-gray-300 text-lg mb-6">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªØŒ Ø§Ù„Ø´Ø±Ø§ÙƒØ§ØªØŒ Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© ØªØ­Ø¯ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø©.. Ù†Ø­Ù† ÙÙŠ Ø®Ø¯Ù…ØªÙƒÙ….</p>
    
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <a href="https://wa.me/905510651347" target="_blank" class="contact-link whatsapp-btn shadow-lg hover:shadow-green-700/50">
            <span class="icon">ğŸ’¬</span>
            ØªÙˆØ§ØµÙ„ ÙÙˆØ±ÙŠ Ø¹Ø¨Ø± **WhatsApp**
        </a>
        
        <a href="https://t.me/bootcadid" target="_blank" class="contact-link telegram-btn shadow-lg hover:shadow-blue-700/50">
            <span class="icon">ğŸš€</span>
            Ù‚Ù†Ø§ØªÙ†Ø§ Ø§Ù„ÙØ®Ù…Ø© Ø¹Ù„Ù‰ **Telegram**
        </a>
        
        <a href="https://www.tiktok.com/@allmhtref" target="_blank" class="contact-link tiktok-btn shadow-lg hover:shadow-gray-700/50">
            <span class="icon">ğŸ¬</span>
            ØªØ§Ø¨Ø¹Ù†Ø§ Ø¹Ù„Ù‰ **TikTok** Ø§Ù„Ø¢Ù†
        </a>

        <a href="mailto:ammarbusi338@gmail.com" class="contact-link email-btn shadow-lg hover:shadow-red-700/50">
            <span class="icon">ğŸ“§</span>
            Ø¥Ø±Ø³Ø§Ù„ Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø¨Ø± **Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„**
        </a>
    </div>
</footer>

<script>
// *** Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ***
const QUIZ_LENGTH=10, TIME_PER_QUESTION=15; 
const QUESTIONS_FILE = 'questions.json';

// *** Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØ§Ù„Ø£ØµÙˆØ§Øª ***
const quizContainer=document.getElementById('quiz'),
      result=document.getElementById('result'),
      nextButton=document.getElementById('next-btn'),
      progressFill=document.getElementById('progress-fill'),
      timerElement=document.getElementById('timer'),
      timerNumber=document.getElementById('timer-number'),
      loadingMessage=document.getElementById('loading-message');

const soundCorrect=document.getElementById('sound-correct'),
      soundWrong=document.getElementById('sound-wrong'),
      soundTimeUp=document.getElementById('sound-timeup');

const backgroundMusic=document.getElementById('background-music'),
      musicToggleButton=document.getElementById('music-toggle-btn');
      
// Ø¹Ù†Ø§ØµØ± Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ±Ø­ÙŠØ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
const loginScreen=document.getElementById('login-screen'),
      usernameInput=document.getElementById('username'),
      passwordInput=document.getElementById('password'),
      loginButton=document.getElementById('login-btn'),
      registerButton=document.getElementById('register-btn'),
      authMessage=document.getElementById('auth-message'),
      welcomeScreen=document.getElementById('welcome-screen'), 
      startButton=document.getElementById('start-quiz-btn'); 

let allQuestions=[], selectedQuestions=[], currentQuestionIndex=0, score=0, answered=false, questionTimer, questionCountdown;
let currentUsername = ''; // Ù„ØªØ®Ø²ÙŠÙ† Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ

// *** 1. Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ ***

function handleRegister() {
    const user = usernameInput.value.trim();
    const pass = passwordInput.value.trim();

    if (user.length < 3 || pass.length < 4) {
        showMessage('Ø§Ù„Ø§Ø³Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù ÙˆØ§Ù„ÙƒÙ„Ù…Ø© 4 ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰.', 'red');
        return;
    }

    if (localStorage.getItem('user_' + user)) {
        showMessage('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„!', 'red');
        return;
    }

    // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨
    localStorage.setItem('user_' + user, pass);
    showMessage(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ø³Ù… ${user} Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.`, 'green');
    passwordInput.value = '';
}

function handleLogin() {
    const user = usernameInput.value.trim();
    const pass = passwordInput.value.trim();
    const storedPass = localStorage.getItem('user_' + user);

    if (storedPass === pass) {
        currentUsername = user;
        localStorage.setItem('lastLoggedInUser', user); // Ø­ÙØ¸ Ø§Ù„Ø§Ø³Ù… Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹
        showMessage(`Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ **${currentUsername}**! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...`, 'green');
        
        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
        setTimeout(() => {
            loginScreen.classList.add('hidden');
            welcomeScreen.classList.remove('hidden');
            // ØªØ­Ø¯ÙŠØ« Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
            document.querySelector('#welcome-screen p:first-child').textContent = `Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ ${currentUsername} ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠ!`;
        }, 1500);
        
    } else {
        showMessage('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.', 'red');
    }
}

function showMessage(text, color) {
    authMessage.innerHTML = text;
    authMessage.className = `mt-4 text-sm font-semibold text-${color}-400`;
    authMessage.classList.remove('hidden');
}


// *** 2. Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ***
async function fetchQuestions() {
    try {
        const response = await fetch(QUESTIONS_FILE);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        allQuestions = await response.json();
        loadingMessage.classList.add('hidden');
        initializeQuestions();
    } catch (error) {
        quizContainer.innerHTML = `<div class="text-red-500 text-xl mt-12"><p>âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©. ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„Ù <b>questions.json</b>.</p></div>`;
        console.error('Error fetching questions:', error);
    }
}

// *** 3. ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ø®ØªÙŠØ§Ø± 10 Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ***
function initializeQuestions() {
    if(allQuestions.length < QUIZ_LENGTH){
        quizContainer.innerHTML = `<p class="text-red-500 text-xl mt-12">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© ÙƒØ§ÙÙŠØ© ÙÙŠ Ù…Ù„Ù ${QUESTIONS_FILE}.</p>`;
        return;
    }
    
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚ÙŠÙ…Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© (Random Seed) Ù„Ø®Ù„Ø· Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
    const seed = Math.floor(Math.random() * 1000000); 

    function seededShuffle(array, currentSeed) {
        let arr = [...array], i = arr.length, j, temp;
        while(i){
            j = (currentSeed + i) % i;
            i--;
            temp = arr[i];
            arr[i] = arr[j];
            arr[j] = temp;
        }
        return arr;
    }

    const shuffledQuestions = seededShuffle(allQuestions, seed);
    selectedQuestions = shuffledQuestions.slice(0, QUIZ_LENGTH).map((q, index) => {
        const answerSeed = seed * 10 + index;
        const answers = q.a.map((text,i)=>({text,isCorrect:i===q.correct}));

        // Ø®Ù„Ø· Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
        let ansArr=[...answers], c=ansArr.length, r, t;
        while(c){
            r=(answerSeed+c)%c;
            c--;
            t=ansArr[c];
            ansArr[c]=ansArr[r];
            ansArr[r]=t;
        }
        const newCorrectIndex = ansArr.findIndex(a=>a.isCorrect);
        return {
            q:q.q,
            a: ansArr.map(a=>a.text),
            correct: newCorrectIndex,
            info: q.info
        };
    });

    currentQuestionIndex=0; score=0;
    result.classList.add('hidden'); 
    timerElement.classList.remove('hidden');
    startQuiz();
}

// *** 4. Ø¯ÙˆØ§Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ***

function startQuiz(){loadQuestion();}

function loadQuestion(){
    clearInterval(questionTimer);
    nextButton.classList.add('hidden');
    answered=false;

    if(currentQuestionIndex>=selectedQuestions.length){
        showFinalResult();
        return;
    }

    const q = selectedQuestions[currentQuestionIndex];
    quizContainer.innerHTML = `
        <div class="question-card mt-6" style="opacity:1; transform:translateY(0);">
            <p class="text-xl md:text-2xl font-bold mb-6 text-yellow-100">Ø§Ù„Ø³Ø¤Ø§Ù„ ${currentQuestionIndex+1} Ù…Ù† ${QUIZ_LENGTH}</p>
            <h2 class="text-2xl md:text-3xl font-extrabold mb-8">${q.q}</h2>
            <div id="answers-container" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                ${q.a.map((answer,index)=>`<button class="answer-btn bg-emerald-700 text-white p-3 rounded-xl shadow-lg hover:bg-emerald-600" data-index="${index}">${answer}</button>`).join('')}
            </div>
            <div id="info-box" class="hidden text-sm mt-4"></div>
            <div class="timer-bar mt-6"><div id="timer-fill" class="timer-fill" style="transition:width ${TIME_PER_QUESTION}s linear;"></div></div>
        </div>
    `;
    document.querySelectorAll('.answer-btn').forEach(btn=>btn.addEventListener('click',checkAnswer));
    updateProgress();
    startQuestionTimer();
}

function startQuestionTimer(){
    let timeLeft=TIME_PER_QUESTION;
    const timerFill=document.getElementById('timer-fill');
    timerNumber.textContent=timeLeft;
    questionCountdown=timeLeft;
    timerFill.style.width='100%';
    timerFill.style.transition=`width ${TIME_PER_QUESTION}s linear`;
    void timerFill.offsetWidth;
    questionTimer=setInterval(()=>{
        questionCountdown--;
        timerNumber.textContent=questionCountdown;
        if(questionCountdown<=0){clearInterval(questionTimer);handleTimeUp();}
    } ,1000);
}

function handleTimeUp(){
    if(!answered){
        soundTimeUp.play().catch(()=>{});
        answered=true;
        const q=selectedQuestions[currentQuestionIndex];
        document.querySelector(`.answer-btn[data-index="${q.correct}"]`).classList.add('correct');
        const infoBox=document.getElementById('info-box');
        infoBox.innerHTML=`**âœ¨ Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¥Ø¶Ø§ÙÙŠØ©:** ${q.info}`;
        infoBox.classList.remove('hidden');
        result.textContent='âŒ› Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ù„Ù… ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ù‚Ø·Ø©.';
        result.className='mt-6 text-2xl md:text-3xl font-bold p-4 rounded-xl shadow-2xl bg-red-800 text-white';
        result.classList.remove('hidden');
        nextButton.classList.remove('hidden');
    }
}

function checkAnswer(event){
    if(answered) return;
    answered=true;
    clearInterval(questionTimer);
    const selectedButton=event.target;
    const selectedIndex=parseInt(selectedButton.dataset.index);
    const q=selectedQuestions[currentQuestionIndex];
    const isCorrect = selectedIndex===q.correct;
    const infoBox=document.getElementById('info-box');

    document.querySelectorAll('.answer-btn').forEach(btn=>{
        if(parseInt(btn.dataset.index)===q.correct) btn.classList.add('correct');
        else if(btn===selectedButton) btn.classList.add('wrong');
        btn.classList.add('answered');
    });

    infoBox.innerHTML=`**âœ¨ Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¥Ø¶Ø§ÙÙŠØ©:** ${q.info}`;
    infoBox.classList.remove('hidden');

    if(isCorrect){score++; soundCorrect.play().catch(()=>{}); result.textContent='âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!'; result.className='mt-6 text-2xl md:text-3xl font-bold p-4 rounded-xl shadow-2xl bg-green-800 text-white';}
    else{soundWrong.play().catch(()=>{}); result.textContent=`âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©. Ø§Ù„ØµØ­ÙŠØ­Ø©: ${q.a[q.correct]}`; result.className='mt-6 text-2xl md:text-3xl font-bold p-4 rounded-xl shadow-2xl bg-red-800 text-white';}

    result.classList.remove('hidden');
    nextButton.classList.remove('hidden');
}

function updateProgress(){
    const percentage=(currentQuestionIndex/QUIZ_LENGTH)*100;
    progressFill.style.width=`${percentage}%`;
}

function showFinalResult(){
    progressFill.style.width='100%';
    quizContainer.innerHTML='';

    let bestScore=parseInt(localStorage.getItem('bestScore')||'0'), isNewRecord=false;
    if(score>bestScore){bestScore=score; localStorage.setItem('bestScore',bestScore); isNewRecord=true;}

    const percentage=(score/selectedQuestions.length)*100;
    let message='';
    if(isNewRecord) message="ğŸ† Ø±Ù‚Ù… Ù‚ÙŠØ§Ø³ÙŠ Ø¬Ø¯ÙŠØ¯! ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ğŸ’¯";
    else if(percentage===100) message="Ù…Ø¨Ø§Ø±Ùƒ! ğŸ‘‘ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©! ğŸ’¯";
    else if(percentage>=70) message=`Ù†ØªÙŠØ¬Ø© Ù…Ù…ØªØ§Ø²Ø©! âœ¨ ${score} Ù…Ù† ${selectedQuestions.length}.`;
    else message=`Ù†ØªÙŠØ¬ØªÙƒ Ù‡ÙŠ: ${score} Ù…Ù† ${selectedQuestions.length}. ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø³ÙŠØ·Ø©. ğŸ“š`;

    result.innerHTML=`<p class="text-3xl md:text-4xl mb-4">Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</p>
        <p class="text-xl md:text-2xl font-bold mb-4">${message}</p>
        ${currentUsername ? `<p class="text-xl md:text-2xl font-bold mb-4 text-yellow-400">Ø§Ù„Ù„Ø§Ø¹Ø¨: ${currentUsername}</p>` : ''}
        <p class="text-lg mb-2">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: ${percentage.toFixed(2)}%</p>
        <p class="text-yellow-300 text-lg font-bold mb-4">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø© Ù„Ø¯ÙŠÙƒ: ${bestScore} Ù…Ù† ${selectedQuestions.length}</p>
        <button onclick="fetchQuestions()" class="mt-4 bg-yellow-500 hover:bg-yellow-400 text-gray-900 font-bold py-2 px-4 rounded-full text-lg transition">Ø§Ø¨Ø¯Ø£ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯</button>`;

    result.classList.remove('hidden');
    nextButton.classList.add('hidden'); 
    timerElement.classList.add('hidden');
}


// *** 5. ÙˆØ¸ÙŠÙØ© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰/Ø¥ÙŠÙ‚Ø§ÙÙ‡Ø§ ***
function toggleMusic(){
    const musicIcon=document.getElementById('music-icon'),musicStatus=document.getElementById('music-status');
    if(backgroundMusic.paused){
        backgroundMusic.play().catch(()=>{
             alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙƒØ§Ù† ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰.');
        });
        musicIcon.textContent='ğŸµ'; 
        musicStatus.textContent='Ø¥ÙŠÙ‚Ø§Ù';
    }
    else{backgroundMusic.pause(); musicIcon.textContent='ğŸ”‡'; musicStatus.textContent='ØªØ´ØºÙŠÙ„';}
}

// *** 6. Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ§Ù„Ø¨Ø¯Ø¡ ***

// Ø£Ø­Ø¯Ø§Ø« Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
loginButton.addEventListener('click', handleLogin);
registerButton.addEventListener('click', handleRegister);

nextButton.addEventListener('click',()=>{
    if(currentQuestionIndex>=selectedQuestions.length){
        fetchQuestions(); 
        nextButton.textContent='Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸';
    }
    else{
        currentQuestionIndex++; 
        result.classList.add('hidden'); 
        loadQuestion();
    }
});

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡
startButton.addEventListener('click', () => {
    welcomeScreen.classList.add('hidden'); 
    loadingMessage.classList.remove('hidden'); 
    backgroundMusic.play().catch(() => {});
    fetchQuestions();
});

musicToggleButton.addEventListener('click',toggleMusic);

// ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', () => {
    backgroundMusic.play().catch(() => {});
    
    // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    welcomeScreen.classList.add('hidden');
    loginScreen.classList.remove('hidden');

    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¢Ø®Ø± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡ Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    const lastUser = localStorage.getItem('lastLoggedInUser');
    if(lastUser) usernameInput.value = lastUser;
});
</script>
</body>
</html>
