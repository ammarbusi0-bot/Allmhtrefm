<script>
const allQuestions=[
{q:"Ù…Ù† Ø£ÙˆÙ„ Ù…Ù† Ø£Ø³Ù„Ù… Ù…Ù† Ø§Ù„Ø±Ø¬Ø§Ù„ Ø§Ù„Ø£Ø­Ø±Ø§Ø±ØŸ",a:["Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚","Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨","Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù†"],correct:0},
{q:"Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªÙØ³Ù…Ù‰ Ù‚Ù„Ø¨ Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ",a:["ÙŠØ³","Ø§Ù„Ø±Ø­Ù…Ù†","Ø§Ù„ÙƒÙ‡Ù"],correct:0},
{q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ØŸ",a:["Ø®Ù…Ø³Ø©","Ø³ØªØ©","Ø³Ø¨Ø¹Ø©"],correct:0},
{q:"Ù…Ø§ Ø£ÙˆÙ„ Ù…Ø§ Ù†Ø²Ù„ Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ",a:["Ø§Ù‚Ø±Ø£ Ø¨Ø§Ø³Ù… Ø±Ø¨Ùƒ","Ø§Ù„ÙØ§ØªØ­Ø©","Ø§Ù„Ù…Ø¯Ø«Ø±"],correct:0},
{q:"Ù…Ø§ Ø§Ø³Ù… ÙˆØ§Ù„Ø¯Ø© Ø§Ù„Ù†Ø¨ÙŠ Ù…Ø­Ù…Ø¯ ï·ºØŸ",a:["Ø¢Ù…Ù†Ø© Ø¨Ù†Øª ÙˆÙ‡Ø¨","Ø®Ø¯ÙŠØ¬Ø© Ø¨Ù†Øª Ø®ÙˆÙŠÙ„Ø¯","Ø­Ù„ÙŠÙ…Ø© Ø§Ù„Ø³Ø¹Ø¯ÙŠØ©"],correct:0},
{q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ",a:["114","112","116"],correct:0},
{q:"ÙÙŠ Ø£ÙŠ Ø¹Ø§Ù… ÙƒØ§Ù†Øª ØºØ²ÙˆØ© Ø¨Ø¯Ø± Ø§Ù„ÙƒØ¨Ø±Ù‰ØŸ",a:["Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ù‡Ø¬Ø±Ø©","Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„Ù‡Ø¬Ø±Ø©","Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ù„Ù„Ù‡Ø¬Ø±Ø©"],correct:0},
{q:"Ù…Ù† Ù‡Ùˆ Ø³ÙŠÙ Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø³Ù„ÙˆÙ„ØŸ",a:["Ø®Ø§Ù„Ø¯ Ø¨Ù† Ø§Ù„ÙˆÙ„ÙŠØ¯","Ø­Ù…Ø²Ø© Ø¨Ù† Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø·Ù„Ø¨","Ø£Ø¨Ùˆ Ø¹Ø¨ÙŠØ¯Ø© Ø¨Ù† Ø§Ù„Ø¬Ø±Ø§Ø­"],correct:0},
{q:"Ù…Ù† Ø§Ù„Ù†Ø¨ÙŠ Ø§Ù„Ø°ÙŠ Ø§Ø¨ØªÙ„Ø¹Ù‡ Ø§Ù„Ø­ÙˆØªØŸ",a:["ÙŠÙˆÙ†Ø³ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…","Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…","Ø£ÙŠÙˆØ¨ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…"],correct:0},
{q:"Ù…Ø§ Ù‡ÙŠ Ø£Ø·ÙˆÙ„ Ø³ÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ",a:["Ø§Ù„Ø¨Ù‚Ø±Ø©","Ø§Ù„Ù†Ø³Ø§Ø¡","Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†"],correct:0}
];

const QUIZ_LENGTH=10,REFRESH_INTERVAL=12*60*60*1000;
const quizContainer=document.getElementById('quiz'),
      result=document.getElementById('result'),
      nextButton=document.getElementById('next-btn'),
      progressFill=document.getElementById('progress-fill'),
      timerElement=document.getElementById('timer'),
      timerValue=document.getElementById('timer-value'),
      startScreen=document.getElementById('start-screen'),
      startBtn=document.getElementById('start-btn');

let selectedQuestions,currentQuestionIndex=0,score=0,answered=false,timerInterval;

startBtn.addEventListener('click',()=>{
startScreen.classList.add('hidden');
document.querySelector('.progress-bar').classList.remove('hidden');
quizContainer.classList.remove('hidden');
initializeQuestions();
showQuestion();
});

function initializeQuestions(){
const now=Date.now();
const lastRefresh=parseInt(localStorage.getItem('lastRefresh')||'0');
let storedQuestions=localStorage.getItem('selectedQuestions');
const isQuizExpired=!lastRefresh||now-lastRefresh>REFRESH_INTERVAL;

if(isQuizExpired||!storedQuestions){
selectedQuestions=[...allQuestions].sort(()=>Math.random()-0.5).slice(0,QUIZ_LENGTH);
// âš ï¸ ÙŠØ¬Ø¨ Ø£ÙŠØ¶Ø§Ù‹ Ø®Ù„Ø· Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø®Ø²Ù†Ø© ÙÙŠ ÙƒÙ„ Ù…Ø±Ø© Ù„Ø¥Ø²Ø§Ù„Ø© Ù†Ù…Ø· Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© (correct: 0)
selectedQuestions = selectedQuestions.map(q => {
    const originalAnswers = q.a.map((text, i) => ({ text, isCorrect: i === q.correct }));
    const shuffledAnswers = originalAnswers.sort(() => Math.random() - 0.5);
    // Ù†Ø­Ø¯Ø¯ Ù…Ø¤Ø´Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ù…Ø²ÙˆØ¬
    const newCorrectIndex = shuffledAnswers.findIndex(ans => ans.isCorrect);
    // Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù…Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ù…Ø²ÙˆØ¬Ø© ÙˆØ§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
    return { q: q.q, a: shuffledAnswers.map(ans => ans.text), correct: newCorrectIndex, originalCorrectAnswer: q.a[q.correct] };
});

localStorage.setItem('selectedQuestions',JSON.stringify(selectedQuestions));
localStorage.setItem('lastRefresh',now);
localStorage.removeItem('currentQuestionIndex');
localStorage.removeItem('score');
currentQuestionIndex=0;score=0;
}else{
selectedQuestions=JSON.parse(storedQuestions);
currentQuestionIndex=parseInt(localStorage.getItem('currentQuestionIndex')||'0');
score=parseInt(localStorage.getItem('score')||'0');
if(currentQuestionIndex>=selectedQuestions.length){localStorage.removeItem('currentQuestionIndex');localStorage.removeItem('score');initializeQuestions();return;}
}
startTimer();
}

function startTimer(){
const lastRefresh=parseInt(localStorage.getItem('lastRefresh')||'0');
const endTime=lastRefresh+REFRESH_INTERVAL;
timerElement.classList.remove('hidden');
if(timerInterval) clearInterval(timerInterval);
timerInterval=setInterval(()=>{
const now=Date.now();
const remaining=endTime-now;
if(remaining<=0){clearInterval(timerInterval);timerValue.textContent="Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! (ÙŠØªÙ… Ø§Ù„ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø¢Ù†)";initializeQuestions();showQuestion();return;}
const totalSeconds=Math.floor(remaining/1000);
const hours=Math.floor(totalSeconds/3600);
const minutes=Math.floor((totalSeconds%3600)/60);
const seconds=totalSeconds%60;
timerValue.textContent=`${hours.toString().padStart(2,'0')} Ø³ Ùˆ ${minutes.toString().padStart(2,'0')} Ø¯ Ùˆ ${seconds.toString().padStart(2,'0')} Ø«`;
},1000);
}

function showQuestion(){
if(currentQuestionIndex>=selectedQuestions.length){showResult();return;}
const q=selectedQuestions[currentQuestionIndex];
answered=false;
nextButton.classList.add('hidden');
progressFill.style.width=`${(currentQuestionIndex/selectedQuestions.length)*100}%`;

// âš ï¸ Ù„Ø§Ø­Ø¸: Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ù…Ù…Ø²ÙˆØ¬Ø© ÙˆÙ…Ø¤Ø´Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…ÙØ­Ø¯Ø« Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ø¯Ø§Ù„Ø© initializeQuestions
// q.a ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ù…Ø²ÙˆØ¬Ø©
// q.correct ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø¤Ø´Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ù…Ø²ÙˆØ¬

quizContainer.innerHTML = `
    <div id="q-card" class="question-card p-6 md:p-8 mb-6">
        <p class="text-xl text-yellow-500 mb-4">Ø³Ø¤Ø§Ù„ ${currentQuestionIndex + 1} Ù…Ù† ${selectedQuestions.length}</p>
        <h2 class="text-2xl md:text-3xl font-bold mb-6 md:mb-8">${q.q}</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4" id="answers-container">
            ${q.a.map((ans,i)=>`
                <button data-index="${i}" onclick="checkAnswer(${i}, this)"
                        class="answer-btn w-full bg-emerald-700 text-white font-semibold py-3 px-4 rounded-xl shadow-md text-base md:text-lg hover:bg-emerald-600">
                    ${ans}
                </button>
            `).join('')}
        </div>
    </div>
`;
}

window.checkAnswer = function(selectedIndex, button){
if(answered) return;
answered=true;
const q = selectedQuestions[currentQuestionIndex];
const answerButtons = document.getElementById('answers-container').children;

Array.from(answerButtons).forEach(btn=>{
  const index=parseInt(btn.getAttribute('data-index'));
  // ğŸ’¡ Ù†Ø³ØªØ®Ø¯Ù… q.correct Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø§Ù„Ù…Ù…Ø²ÙˆØ¬) Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
  if(index===q.correct){btn.classList.add('correct');}
  else if(index===selectedIndex){btn.classList.add('wrong');}
  else{btn.classList.add('opacity-50');}
  btn.classList.add('answered');
});

// ğŸ’¡ Ù†Ø³ØªØ®Ø¯Ù… Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø§Ù„Ù…Ù…Ø²ÙˆØ¬)
const correctAnswerText = q.a[q.correct];

if(selectedIndex===q.correct){
  score++;
  result.classList.remove('hidden');
  result.textContent="âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!";
  result.classList.remove('text-red-400','bg-red-900/50');
  result.classList.add('text-green-400','bg-green-900/50');
}
else{
  result.classList.remove('hidden');
  result.textContent="âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©. Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ: " + correctAnswerText;
  result.classList.remove('text-green-400','bg-green-900/50');
  result.classList.add('text-red-400','bg-red-900/50');
}

nextButton.classList.remove('hidden');
localStorage.setItem('score',score);
}

window.nextQuestion=function(){
currentQuestionIndex++;
localStorage.setItem('currentQuestionIndex',currentQuestionIndex);
result.classList.add('hidden');
showQuestion();
}

function showResult(){
quizContainer.innerHTML='';
nextButton.classList.add('hidden');
result.classList.remove('hidden','bg-red-900/50','bg-green-900/50');
result.classList.add('text-yellow-300','bg-slate-800/80','p-6');
progressFill.style.width='100%';
const percentage=(score/selectedQuestions.length)*100;
let message='';
if(percentage===100) message="Ù…Ø¨Ø§Ø±Ùƒ! ğŸ‘‘ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©! ğŸ’¯";
else if(percentage>=70) message=`Ù†ØªÙŠØ¬Ø© Ù…Ù…ØªØ§Ø²Ø©! âœ¨ ${score} Ù…Ù† ${selectedQuestions.length}.`;
else if(percentage>=50) message=`Ù†ØªÙŠØ¬Ø© Ø¬ÙŠØ¯Ø©! ğŸ‘ ${score} Ù…Ù† ${selectedQuestions.length}.`;
else message=`Ù†ØªÙŠØ¬ØªÙƒ Ù‡ÙŠ: ${score} Ù…Ù† ${selectedQuestions.length}. ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø³ÙŠØ·Ø©. ğŸ“š`;
result.innerHTML=`<p class="text-3xl md:text-4xl mb-4">Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</p><p class="text-xl md:text-2xl font-bold mb-4">${message}</p><p class="text-lg mb-4">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: ${percentage.toFixed(2)}%</p><button onclick="restartQuiz()" class="mt-4 bg-yellow-500 hover:bg-yellow-400 text-gray-900 font-bold py-2 px-4 rounded-full text-lg transition">Ø§Ø¨Ø¯Ø£ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯</button>`;
localStorage.removeItem('currentQuestionIndex');
localStorage.removeItem('score');
if(timerInterval) clearInterval(timerInterval);
timerElement.classList.add('hidden');
}

window.restartQuiz=function(){
localStorage.removeItem('selectedQuestions');
localStorage.removeItem('lastRefresh');
initializeQuestions();
currentQuestionIndex=0;
score=0;
result.classList.add('hidden');
showQuestion();
}
</script>
</body>
</html>
