const allQuestions=[
{q:"Ù…Ù† Ø£ÙˆÙ„ Ù…Ù† Ø£Ø³Ù„Ù… Ù…Ù† Ø§Ù„Ø±Ø¬Ø§Ù„ Ø§Ù„Ø£Ø­Ø±Ø§Ø±ØŸ",a:["Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚","Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨","Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù†"],correct:0, info:"Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚ Ø±Ø¶ÙŠ Ø§Ù„Ù„Ù‡ Ø¹Ù†Ù‡ Ù‡Ùˆ Ø£ÙˆÙ„ Ù…Ù† Ø£Ø³Ù„Ù… Ù…Ù† Ø§Ù„Ø±Ø¬Ø§Ù„ Ø§Ù„Ø£Ø­Ø±Ø§Ø±."},
{q:"Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªÙØ³Ù…Ù‰ Ù‚Ù„Ø¨ Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ",a:["ÙŠØ³","Ø§Ù„Ø±Ø­Ù…Ù†","Ø§Ù„ÙƒÙ‡Ù"],correct:0, info:"Ø³ÙˆØ±Ø© ÙŠØ³ ØªÙØ³Ù…Ù‰ Ù‚Ù„Ø¨ Ø§Ù„Ù‚Ø±Ø¢Ù† Ù„Ù…Ø§ ÙˆØ±Ø¯ Ø¹Ù† Ø§Ù„Ù†Ø¨ÙŠ ï·º."},
{q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ØŸ",a:["Ø®Ù…Ø³Ø©","Ø³ØªØ©","Ø³Ø¨Ø¹Ø©"],correct:0, info:"Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø¥Ø³Ù„Ø§Ù… Ø®Ù…Ø³Ø©: Ø§Ù„Ø´Ù‡Ø§Ø¯ØªØ§Ù†ØŒ Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø§Ù„Ø²ÙƒØ§Ø©ØŒ Ø§Ù„ØµÙˆÙ…ØŒ ÙˆØ§Ù„Ø­Ø¬."},
{q:"Ù…Ø§ Ø£ÙˆÙ„ Ù…Ø§ Ù†Ø²Ù„ Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ",a:["Ø§Ù‚Ø±Ø£ Ø¨Ø§Ø³Ù… Ø±Ø¨Ùƒ","Ø§Ù„ÙØ§ØªØ­Ø©","Ø§Ù„Ù…Ø¯Ø«Ø±"],correct:0, info:"Ø£ÙˆÙ„ Ù…Ø§ Ù†Ø²Ù„ Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… Ù‡ÙŠ Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø³ÙˆØ±Ø© Ø§Ù„Ø¹Ù„Ù‚."},
{q:"Ù…Ø§ Ø§Ø³Ù… ÙˆØ§Ù„Ø¯Ø© Ø§Ù„Ù†Ø¨ÙŠ Ù…Ø­Ù…Ø¯ ï·ºØŸ",a:["Ø¢Ù…Ù†Ø© Ø¨Ù†Øª ÙˆÙ‡Ø¨","Ø®Ø¯ÙŠØ¬Ø© Ø¨Ù†Øª Ø®ÙˆÙŠÙ„Ø¯","Ø­Ù„ÙŠÙ…Ø© Ø§Ù„Ø³Ø¹Ø¯ÙŠØ©"],correct:0, info:"ÙˆØ§Ù„Ø¯Ø© Ø§Ù„Ù†Ø¨ÙŠ ï·º Ù‡ÙŠ Ø¢Ù…Ù†Ø© Ø¨Ù†Øª ÙˆÙ‡Ø¨."},
{q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ",a:["114","112","116"],correct:0, info:"ÙŠØ¨Ù„Øº Ø¹Ø¯Ø¯ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… 114 Ø³ÙˆØ±Ø©."},
{q:"ÙÙŠ Ø£ÙŠ Ø¹Ø§Ù… ÙƒØ§Ù†Øª ØºØ²ÙˆØ© Ø¨Ø¯Ø± Ø§Ù„ÙƒØ¨Ø±Ù‰ØŸ",a:["Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ù‡Ø¬Ø±Ø©","Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„Ù‡Ø¬Ø±Ø©","Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ù„Ù„Ù‡Ø¬Ø±Ø©"],correct:0, info:"ÙˆÙ‚Ø¹Øª ØºØ²ÙˆØ© Ø¨Ø¯Ø± Ø§Ù„ÙƒØ¨Ø±Ù‰ ÙÙŠ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ù‡Ø¬Ø±Ø©."},
{q:"Ù…Ù† Ù‡Ùˆ Ø³ÙŠÙ Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø³Ù„ÙˆÙ„ØŸ",a:["Ø®Ø§Ù„Ø¯ Ø¨Ù† Ø§Ù„ÙˆÙ„ÙŠØ¯","Ø­Ù…Ø²Ø© Ø¨Ù† Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø·Ù„Ø¨","Ø£Ø¨Ùˆ Ø¹Ø¨ÙŠØ¯Ø© Ø¨Ù† Ø§Ù„Ø¬Ø±Ø§Ø­"],correct:0, info:"Ø®Ø§Ù„Ø¯ Ø¨Ù† Ø§Ù„ÙˆÙ„ÙŠØ¯ Ø±Ø¶ÙŠ Ø§Ù„Ù„Ù‡ Ø¹Ù†Ù‡ØŒ Ù„Ù‚Ø¨Ù‡ Ø§Ù„Ù†Ø¨ÙŠ ï·º Ø¨Ù€ Ø³ÙŠÙ Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø³Ù„ÙˆÙ„."},
{q:"Ù…Ù† Ø§Ù„Ù†Ø¨ÙŠ Ø§Ù„Ø°ÙŠ Ø§Ø¨ØªÙ„Ø¹Ù‡ Ø§Ù„Ø­ÙˆØªØŸ",a:["ÙŠÙˆÙ†Ø³ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…","Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…","Ø£ÙŠÙˆØ¨ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…"],correct:0, info:"Ø§Ù„Ù†Ø¨ÙŠ ÙŠÙˆÙ†Ø³ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù… Ø§Ø¨ØªÙ„Ø¹Ù‡ Ø§Ù„Ø­ÙˆØª ÙˆØ¨Ù‚ÙŠ ÙÙŠ Ø¨Ø·Ù†Ù‡ ÙØªØ±Ø© Ø«Ù… Ù†Ø¬Ø§Ù‡ Ø§Ù„Ù„Ù‡."},
{q:"Ù…Ø§ Ù‡ÙŠ Ø£Ø·ÙˆÙ„ Ø³ÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ",a:["Ø§Ù„Ø¨Ù‚Ø±Ø©","Ø§Ù„Ù†Ø³Ø§Ø¡","Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†"],correct:0, info:"Ø£Ø·ÙˆÙ„ Ø³ÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ù‡ÙŠ Ø§Ù„Ø¨Ù‚Ø±Ø©."}
];

// ** ØªÙ… ØªØ¹Ø¯ÙŠÙ„ REFRESH_INTERVAL Ø¥Ù„Ù‰ 10 Ø¯Ù‚Ø§Ø¦Ù‚ **
const QUIZ_LENGTH=10,REFRESH_INTERVAL=10*60*1000,TIME_PER_QUESTION=15;
const quizContainer=document.getElementById('quiz'),
      result=document.getElementById('result'),
      nextButton=document.getElementById('next-btn'),
      progressFill=document.getElementById('progress-fill'),
      timerElement=document.getElementById('timer'),
      timerValue=document.getElementById('timer-value'),
      timerNumber=document.getElementById('timer-number');

const soundCorrect=document.getElementById('sound-correct'),
      soundWrong=document.getElementById('sound-wrong'),
      soundNext=document.getElementById('sound-next'),
      soundTimeUp=document.getElementById('sound-timeup');

const backgroundMusic=document.getElementById('background-music'),
      musicToggleButton=document.getElementById('music-toggle-btn'),
      musicIcon=document.getElementById('music-icon'),
      musicStatus=document.getElementById('music-status');

let isMusicPlaying=false,selectedQuestions,currentQuestionIndex=0,score=0,answered=false,timerInterval,questionTimer,questionCountdown;

musicToggleButton.addEventListener('click',()=>{toggleMusic();});

function toggleMusic(){
    if(isMusicPlaying){backgroundMusic.pause();isMusicPlaying=false;musicIcon.textContent='ðŸ”‡';musicStatus.textContent='ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰';}
    else{backgroundMusic.play().catch(()=>{});isMusicPlaying=true;musicIcon.textContent='ðŸŽµ';musicStatus.textContent='Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰';}
}

function initializeQuestions(){
    // Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…Ø¶Ø§Ù Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© Ø£Ø³Ø¦Ù„Ø© Ø«Ø§Ø¨ØªØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
    const now = Date.now();
    const intervalSeed = Math.floor(now / REFRESH_INTERVAL);
    
    // Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Fisher-Yates shuffle Ù„Ø®Ù„Ø· Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¨Ù€ "Ø¨Ø°Ø±Ø©" Ø«Ø§Ø¨ØªØ© ÙÙŠ ÙƒÙ„ ÙØªØ±Ø©
    function seededShuffle(array, seed) {
        let currentIndex = array.length, temporaryValue, randomIndex;
        while (0 !== currentIndex) {
            randomIndex = (seed + currentIndex) % currentIndex;
            currentIndex -= 1;
            temporaryValue = array[currentIndex];
            array[currentIndex] = array[randomIndex];
            array[randomIndex] = temporaryValue;
        }
        return array;
    }

    // Ù†Ø³Ø® ÙˆØ®Ù„Ø· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø«Ù… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙˆÙ„ 10
    const shuffledQuestions = seededShuffle([...allQuestions], intervalSeed);
    selectedQuestions = shuffledQuestions.slice(0, QUIZ_LENGTH);
    
    currentQuestionIndex = 0;
    score = 0;
    result.classList.add('hidden');
    timerElement.classList.remove('hidden');
    startQuiz();
    updateRefreshTimer(now);
}

function startQuiz() {
    loadQuestion();
}

function loadQuestion() {
    // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ù…Ø¤Ù‚Øª Ø³Ø§Ø¨Ù‚ ÙˆØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ
    clearInterval(questionTimer);
    nextButton.classList.add('hidden');
    answered = false;
    
    if (currentQuestionIndex >= selectedQuestions.length) {
        showFinalResult();
        return;
    }

    const q = selectedQuestions[currentQuestionIndex];
    quizContainer.innerHTML = `
        <div class="question-card mt-6" style="opacity:1; transform:translateY(0);">
            <p class="text-xl md:text-2xl font-bold mb-6 text-yellow-100">Ø§Ù„Ø³Ø¤Ø§Ù„ ${currentQuestionIndex + 1} Ù…Ù† ${QUIZ_LENGTH}</p>
            <h2 class="text-2xl md:text-3xl font-extrabold mb-8">${q.q}</h2>
            <div id="answers-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                ${q.a.map((answer, index) => `
                    <button class="answer-btn bg-teal-700 text-white p-3 rounded-xl shadow-lg hover:bg-teal-600" data-index="${index}">${answer}</button>
                `).join('')}
            </div>
            <div id="info-box" class="hidden text-sm mt-4"></div>
            <div class="timer-bar mt-6">
                <div id="timer-fill" class="timer-fill" style="transition:width ${TIME_PER_QUESTION}s linear;"></div>
            </div>
        </div>
    `;

    document.querySelectorAll('.answer-btn').forEach(btn => {
        btn.addEventListener('click', checkAnswer);
    });
    
    updateProgress();
    startQuestionTimer();
}

function startQuestionTimer() {
    let timeLeft = TIME_PER_QUESTION;
    const timerFill = document.getElementById('timer-fill');
    timerNumber.textContent = timeLeft;

    questionCountdown = timeLeft;

    timerFill.style.width = '100%';
    timerFill.style.transition = `width ${TIME_PER_QUESTION}s linear`;
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†Ù…ÙŠØ´Ù†
    void timerFill.offsetWidth; 

    questionTimer = setInterval(() => {
        questionCountdown--;
        timerNumber.textContent = questionCountdown;
        if (questionCountdown <= 0) {
            clearInterval(questionTimer);
            handleTimeUp();
        }
    }, 1000);
}

function handleTimeUp() {
    if (!answered) {
        soundTimeUp.play().catch(()=>{});
        answered = true;
        const q = selectedQuestions[currentQuestionIndex];
        const answersContainer = document.getElementById('answers-container');
        answersContainer.classList.add('answered');
        
        // ØªØ¸Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
        document.querySelector(`.answer-btn[data-index="${q.correct}"]`).classList.add('correct');
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
        const infoBox = document.getElementById('info-box');
        infoBox.textContent = q.info;
        infoBox.classList.remove('hidden');

        result.textContent = 'Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! â³ Ù„Ù… ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ù‚Ø·Ø©.';
        result.className = 'mt-6 text-2xl md:text-3xl font-bold p-4 rounded-xl shadow-2xl bg-red-800 text-white';
        result.classList.remove('hidden');
        
        nextButton.classList.remove('hidden');
    }
}

function checkAnswer(event) {
    if (answered) return;
    answered = true;
    clearInterval(questionTimer);
    
    const selectedButton = event.target;
    const selectedIndex = parseInt(selectedButton.dataset.index);
    const q = selectedQuestions[currentQuestionIndex];
    const isCorrect = selectedIndex === q.correct;
    
    const answersContainer = document.getElementById('answers-container');
    answersContainer.classList.add('answered');
    
    // ØªØ¸Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
    document.querySelectorAll('.answer-btn').forEach(btn => {
        if (parseInt(btn.dataset.index) === q.correct) {
            btn.classList.add('correct');
        } else if (btn === selectedButton) {
            btn.classList.add('wrong');
        }
        btn.classList.add('answered');
    });
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
    const infoBox = document.getElementById('info-box');
    infoBox.textContent = q.info;
    infoBox.classList.remove('hidden');

    if (isCorrect) {
        score++;
        soundCorrect.play().catch(()=>{});
        result.textContent = 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ðŸŽ‰';
        result.className = 'mt-6 text-2xl md:text-3xl font-bold p-4 rounded-xl shadow-2xl bg-green-800 text-white';
    } else {
        soundWrong.play().catch(()=>{});
        result.textContent = 'Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! ðŸ˜”';
        result.className = 'mt-6 text-2xl md:text-3xl font-bold p-4 rounded-xl shadow-2xl bg-red-800 text-white';
    }
    
    result.classList.remove('hidden');
    nextButton.classList.remove('hidden');
}

function updateProgress() {
    const percentage = ((currentQuestionIndex) / QUIZ_LENGTH) * 100;
    progressFill.style.width = `${percentage}%`;
}

function showFinalResult() {
    progressFill.style.width = '100%';
    quizContainer.innerHTML = '';
    result.textContent = `Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±! ðŸŽ‰ Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${score} Ù…Ù† ${QUIZ_LENGTH} Ù†Ù‚Ø§Ø·.`;
    result.className = 'mt-6 text-3xl font-bold p-6 rounded-xl shadow-2xl bg-yellow-600 text-gray-900';
    result.classList.remove('hidden');
    nextButton.textContent = 'Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯ ðŸ”„';
    nextButton.classList.remove('hidden');
    timerElement.classList.add('hidden');
}

function updateRefreshTimer(startTime) {
    const nextRefresh = startTime + REFRESH_INTERVAL;
    
    setInterval(() => {
        const now = Date.now();
        const remaining = nextRefresh - now;
        
        if (remaining <= 0) {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
            location.reload(); 
            return;
        }

        const seconds = Math.floor((remaining / 1000) % 60);
        const minutes = Math.floor((remaining / 1000 / 60) % 60);
        
        timerValue.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }, 1000);
}

// Ù…Ø¹Ø§Ù„Ø¬ Ø²Ø± "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ"
nextButton.addEventListener('click', () => {
    if (currentQuestionIndex >= selectedQuestions.length) {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø²Ø± ÙŠØ¹Ø±Ø¶ "Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯"
        initializeQuestions();
        nextButton.textContent = 'Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ âž¡ï¸';
    } else {
        soundNext.play().catch(()=>{});
        currentQuestionIndex++;
        result.classList.add('hidden');
        loadQuestion();
    }
});

// Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
initializeQuestions();
